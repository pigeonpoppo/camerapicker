<!DOCTYPE html>
<html lang="ja">
<head>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#3b82f6">
  <link rel="apple-touch-icon" href="images/icons/icon-192x192.png">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>あなたの撮影スタイル診断結果</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Noto+Sans+JP:wght@300;400;500;600;700;800;900&display=swap');
    
    :root {
      --color-black: #000000;
      --color-gray-900: #0f0f0f;
      --color-gray-800: #1a1a1a;
      --color-gray-700: #2d2d2d;
      --color-gray-600: #404040;
      --color-gray-500: #737373;
      --color-gray-400: #a3a3a3;
      --color-gray-300: #d4d4d4;
      --color-gray-200: #e5e5e5;
      --color-gray-100: #f5f5f5;
      --color-gray-50: #fafafa;
      --color-white: #ffffff;
      
      --color-blue: #2563eb;
      --color-green: #059669;
      --color-purple: #7c3aed;
      --color-orange: #ea580c;
      --color-red: #dc2626;
      
      --font-sans: 'Inter', 'Noto Sans JP', -apple-system, BlinkMacSystemFont, sans-serif;
      --font-mono: 'JetBrains Mono', 'SF Mono', Monaco, 'Cascadia Code', monospace;
      
      --line-height-tight: 1.25;
      --line-height-snug: 1.375;
      --line-height-normal: 1.5;
      --line-height-relaxed: 1.625;
      --line-height-loose: 2;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: var(--font-sans);
      background-color: var(--color-white);
      color: var(--color-gray-900);
      line-height: var(--line-height-normal);
      overflow-x: hidden;
    }
    
    /* Typography System */
    .text-xs { font-size: 0.75rem; }
    .text-sm { font-size: 0.875rem; }
    .text-base { font-size: 1rem; }
    .text-lg { font-size: 1.125rem; }
    .text-xl { font-size: 1.25rem; }
    .text-2xl { font-size: 1.5rem; }
    .text-3xl { font-size: 1.875rem; }
    .text-4xl { font-size: 2.25rem; }
    .text-5xl { font-size: 3rem; }
    .text-6xl { font-size: 3.75rem; }
    .text-7xl { font-size: 4.5rem; }
    
    .font-light { font-weight: 300; }
    .font-normal { font-weight: 400; }
    .font-medium { font-weight: 500; }
    .font-semibold { font-weight: 600; }
    .font-bold { font-weight: 700; }
    .font-extrabold { font-weight: 800; }
    .font-black { font-weight: 900; }
    
    /* Layout System */
    .container {
      max-width: 768px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }
    
    .wide-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }
    
    /* Header */
    .header {
      position: sticky;
      top: 0;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--color-gray-200);
      z-index: 100;
      padding: 1rem 0;
    }
    
    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .logo {
      font-weight: 600;
      color: var(--color-gray-900);
      text-decoration: none;
    }
    
    .share-button {
      background: var(--color-gray-900);
      color: var(--color-white);
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .share-button:hover {
      background: var(--color-gray-700);
    }
    
    /* Article Layout */
    .article {
      padding: 4rem 0;
    }
    
    .article-header {
      margin-bottom: 4rem;
      text-align: center;
    }
    
    .article-meta {
      color: var(--color-gray-500);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      font-size: 0.75rem;
      font-weight: 600;
      margin-bottom: 1rem;
    }
    
    .article-title {
      font-size: 3.75rem;
      font-weight: 800;
      line-height: var(--line-height-tight);
      margin-bottom: 1.5rem;
      letter-spacing: -0.02em;
    }
    
    .article-title .line-break {
      display: block;
    }
    
    .article-title .personality-type {
      font-size: 3.5rem;
      display: block;
      margin-top: 0.5rem;
    }
    
    .article-subtitle {
      font-size: 1.25rem;
      color: var(--color-gray-600);
      font-weight: 400;
      line-height: var(--line-height-relaxed);
      max-width: 600px;
      margin: 0 auto;
    }
    
    /* Content Sections */
    .content-section {
      margin-bottom: 4rem;
    }
    
    .section-header {
      margin-bottom: 2rem;
    }
    
    .section-number {
      color: var(--color-gray-400);
      font-size: 0.875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 0.5rem;
    }
    
    .section-title {
      font-size: 2.25rem;
      font-weight: 700;
      line-height: var(--line-height-tight);
      margin-bottom: 1rem;
    }
    
    .section-description {
      font-size: 1.125rem;
      color: var(--color-gray-600);
      line-height: var(--line-height-relaxed);
    }
    
    /* Personality Card */
    .personality-card {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border: 1px solid var(--color-gray-200);
      border-radius: 1rem;
      padding: 3rem;
      margin: 3rem 0;
      text-align: center;
      position: relative;
    }
    
    .personality-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 4px;
      background: linear-gradient(90deg, var(--color-blue), var(--color-purple));
      border-radius: 2px;
    }
    
    .personality-emoji {
      font-size: 4rem;
      margin-bottom: 1.5rem;
    }
    
    .personality-type {
      font-size: 2rem;
      font-weight: 800;
      color: var(--color-gray-900);
      margin-bottom: 1rem;
      line-height: var(--line-height-tight);
    }
    
    .personality-tagline {
      font-size: 1.125rem;
      color: var(--color-gray-600);
      font-style: italic;
      margin-bottom: 2rem;
    }
    
    .personality-description {
      font-size: 1rem;
      line-height: var(--line-height-relaxed);
      color: var(--color-gray-700);
    }
    
    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 2rem;
      margin: 3rem 0;
    }
    
    .stat-card {
      text-align: center;
      padding: 1.5rem;
      background: var(--color-white);
      border: 1px solid var(--color-gray-200);
      border-radius: 0.75rem;
    }
    
    .stat-number {
      font-size: 2.5rem;
      font-weight: 800;
      color: var(--color-gray-900);
      display: block;
      margin-bottom: 0.5rem;
    }
    
    .stat-label {
      font-size: 0.875rem;
      color: var(--color-gray-500);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
    }
    
    /* Recommendations Grid */
    .recommendations-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin: 3rem 0;
    }
    
    /* モバイル対応 */
    @media (max-width: 768px) {
      .recommendations-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
        margin: 2rem 0;
      }
      
      .recommendation-card {
        margin-bottom: 1rem;
      }
      
      .recommendation-image {
        height: 160px;
      }
      
      .recommendation-content {
        padding: 1rem;
      }
      
      .recommendation-name {
        font-size: 1.125rem;
      }
      
      .recommendation-price {
        font-size: 1rem;
      }
      
      .recommendation-reason {
        font-size: 0.8rem;
        padding: 0.75rem;
      }
    }
    
    .recommendation-card {
      background: var(--color-white);
      border: 1px solid var(--color-gray-200);
      border-radius: 1rem;
      overflow: hidden;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    
    .recommendation-card:hover {
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      transform: translateY(-2px);
    }
    
    .recommendation-image {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-bottom: 1px solid var(--color-gray-200);
    }
    
    .recommendation-content {
      padding: 1.25rem;
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .recommendation-brand {
      font-size: 0.75rem;
      color: var(--color-gray-500);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    
    .recommendation-name {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--color-gray-900);
      margin-bottom: 0.5rem;
      line-height: var(--line-height-snug);
    }
    
    .recommendation-price {
      font-size: 1.125rem;
      font-weight: 600;
      color: var(--color-blue);
      margin-bottom: 1rem;
    }
    
    .recommendation-reason {
      font-size: 0.875rem;
      color: var(--color-gray-600);
      line-height: var(--line-height-relaxed);
      background: var(--color-gray-50);
      padding: 1rem;
      border-radius: 0.5rem;
      margin-top: auto;
      flex: 1;
    }
    
    /* Feature List */
    .feature-list {
      list-style: none;
      margin: 2rem 0;
    }
    
    .feature-item {
      display: flex;
      align-items: flex-start;
      padding: 1rem 0;
      border-bottom: 1px solid var(--color-gray-100);
    }
    
    .feature-item:last-child {
      border-bottom: none;
    }
    
    .feature-icon {
      width: 24px;
      height: 24px;
      background: var(--color-blue);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-white);
      font-weight: 600;
      font-size: 0.75rem;
      margin-right: 1rem;
      flex-shrink: 0;
      margin-top: 0.125rem;
    }
    
    .feature-content h4 {
      font-weight: 600;
      color: var(--color-gray-900);
      margin-bottom: 0.25rem;
    }
    
    .feature-content p {
      color: var(--color-gray-600);
      font-size: 0.875rem;
      line-height: var(--line-height-relaxed);
    }
    
    /* Quote Block */
    .quote-block {
      background: var(--color-gray-50);
      border-left: 4px solid var(--color-blue);
      padding: 2rem;
      margin: 3rem 0;
      border-radius: 0 0.75rem 0.75rem 0;
    }
    
    .quote-text {
      font-size: 1.25rem;
      font-style: italic;
      color: var(--color-gray-700);
      line-height: var(--line-height-relaxed);
      margin-bottom: 1rem;
    }
    
    .quote-author {
      font-size: 0.875rem;
      color: var(--color-gray-500);
      font-weight: 600;
    }
    
    /* Action Buttons */
    .action-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin: 4rem 0;
      flex-wrap: wrap;
    }
    
    .action-button {
      padding: 0.75rem 2rem;
      border: 2px solid var(--color-gray-900);
      background: var(--color-white);
      color: var(--color-gray-900);
      text-decoration: none;
      border-radius: 0.5rem;
      font-weight: 600;
      transition: all 0.2s ease;
    }
    
    .action-button:hover {
      background: var(--color-gray-900);
      color: var(--color-white);
    }
    
    .action-button.primary {
      background: var(--color-gray-900);
      color: var(--color-white);
    }
    
    .action-button.primary:hover {
      background: var(--color-gray-700);
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .container {
        padding: 0 1rem;
      }
      
      .article-title {
        font-size: 2rem;
      }
      
      .article-subtitle {
        font-size: 1rem;
      }
      
      .section-title {
        font-size: 1.5rem;
      }
      
      .personality-card {
        padding: 1.5rem;
      }
      
      .personality-emoji {
        font-size: 2.5rem;
      }
      
      .personality-type {
        font-size: 1.5rem;
      }
      
      .recommendations-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      
      .recommendation-card {
        padding: 1rem;
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
      }
      
      .stat-number {
        font-size: 1.5rem;
      }
      
      .action-buttons {
        flex-direction: column;
        align-items: center;
        gap: 0.75rem;
      }
      
      .action-button {
        width: 100%;
        padding: 1rem;
        font-size: 1rem;
        min-height: 48px;
      }
    }
    
    @media (max-width: 480px) {
      .container {
        padding: 0 0.75rem;
      }
      
      .article-title {
        font-size: 1.75rem;
      }
      
      .personality-card {
        padding: 1rem;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .recommendation-card {
        padding: 0.75rem;
      }
    }
    
    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .animate-in {
      animation: fadeInUp 0.6s ease-out;
    }
    
    /* Print Styles */
    @media print {
      .header,
      .action-buttons {
        display: none;
      }
      
      .article {
        padding: 0;
      }
      
      .container {
        max-width: none;
        padding: 0;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="container">
      <div class="header-content">
                 <a href="index.html" class="logo">Camera Picker</a>
        <button class="share-button" onclick="shareResults()">結果をシェア</button>
      </div>
    </div>
  </header>

  <article class="article">
    <div class="container">
      <header class="article-header">
        <div class="article-meta">Camera Picker 診断結果</div>
        <h1 class="article-title">
          <span class="line-break">あなたは</span>
          <span class="personality-type" id="dynamic-personality-type">「カメラ愛好家」</span>
        </h1>
        <p class="article-subtitle">
          カメラを通じて世界を記録し、表現することを楽しむタイプです。
        </p>
      </header>

      <div class="personality-card animate-in">
        <div class="personality-emoji">📸</div>
        <h2 class="personality-type" id="dynamic-personality-type-card">カメラ愛好家</h2>
        <p class="personality-tagline">「世界を記録する表現者」</p>
        <p class="personality-description">
          カメラを通じて世界を記録し、表現することを楽しむタイプです。様々な被写体に興味を持ち、新しい技術や表現方法を積極的に取り入れながら、自分なりの写真スタイルを追求します。
        </p>
      </div>

      <section class="content-section">
        <div class="section-header">
          <div class="section-number">01</div>
          <h2 class="section-title">あなたの撮影スタイル分析</h2>
          <p class="section-description">
            診断結果から見えてきた、あなたの撮影における特徴と傾向をまとめました。
          </p>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <span class="stat-number">87</span>
            <span class="stat-label">探究心スコア</span>
          </div>
          <div class="stat-card">
            <span class="stat-number">73</span>
            <span class="stat-label">技術志向度</span>
          </div>
          <div class="stat-card">
            <span class="stat-number">91</span>
            <span class="stat-label">汎用性重視</span>
          </div>
          <div class="stat-card">
            <span class="stat-number">68</span>
            <span class="stat-label">予算柔軟性</span>
          </div>
        </div>


      </section>

      <section class="content-section">
        <div class="section-header">
          <div class="section-number">02</div>
          <h2 class="section-title">あなたにおすすめの機材</h2>
          <p class="section-description">
            あなたの撮影スタイルと成長意欲に最適化された機材を厳選しました。
          </p>
        </div>

        <div class="recommendations-grid">
          <div class="recommendation-card">
            <img src="https://via.placeholder.com/400x200?text=Sony+α7+IV" alt="Sony α7 IV" class="recommendation-image">
            <div class="recommendation-content">
              <div class="recommendation-brand">Sony</div>
              <h3 class="recommendation-name">α7 IV</h3>
              <div class="recommendation-price">¥298,000</div>
              <div class="recommendation-reason">
                <strong>推薦理由：</strong>フルサイズセンサーでありながら動画性能も高く、多様な撮影シーンに対応。豊富なレンズ群で表現の幅を広げられます。
              </div>
            </div>
          </div>

          <div class="recommendation-card">
            <img src="https://via.placeholder.com/400x200?text=Canon+EOS+R6+Mark+II" alt="Canon EOS R6 Mark II" class="recommendation-image">
            <div class="recommendation-content">
              <div class="recommendation-brand">Canon</div>
              <h3 class="recommendation-name">EOS R6 Mark II</h3>
              <div class="recommendation-price">¥348,000</div>
              <div class="recommendation-reason">
                <strong>推薦理由：</strong>高感度性能に優れ、手ブレ補正も強力。スポーツから風景まで、あらゆるシーンで安定した性能を発揮します。
              </div>
            </div>
          </div>

          <div class="recommendation-card">
            <img src="https://via.placeholder.com/400x200?text=Fujifilm+X-T5" alt="Fujifilm X-T5" class="recommendation-image">
            <div class="recommendation-content">
              <div class="recommendation-brand">Fujifilm</div>
              <h3 class="recommendation-name">X-T5</h3>
              <div class="recommendation-price">¥248,000</div>
              <div class="recommendation-reason">
                <strong>推薦理由：</strong>高解像度と優れた色再現性で、クリエイティブな表現を追求するあなたにぴったり。コンパクトながら本格的な機能を搭載。
              </div>
            </div>
          </div>
        </div>
      </section>

      <div class="quote-block">
        <p class="quote-text">
          「最良の機材とは、あなたの創造性を制限するのではなく、新たな表現の扉を開いてくれるものです。」
        </p>
        <p class="quote-author">— Camera Picker チーム</p>
      </div>

      <section class="content-section">
        <div class="section-header">
          <div class="section-number">03</div>
          <h2 class="section-title">成長のためのアドバイス</h2>
          <p class="section-description">
            探究型のあなたが更なる成長を遂げるための具体的な提案です。
          </p>
        </div>

                <ul class="feature-list">
          <!-- アドバイスはJavaScriptで動的に生成されます -->
        </ul>
      </section>

      <div class="action-buttons">
        <a href="#" class="action-button" onclick="retakeDiagnosis()">もう一度診断する</a>
        <a href="#" class="action-button primary" onclick="exploreGear()">おすすめ機材を詳しく見る</a>
        <a href="#" class="action-button" onclick="saveResults()">結果を保存</a>
      </div>
    </div>
  </article>

  <script>
    // AI診断結果を表示する関数
    function displayAIDiagnosis() {
      console.log('🔍 displayAIDiagnosis開始');
      
      const results = JSON.parse(localStorage.getItem('cameraPickerResults') || '{}');
      console.log('📊 localStorage結果:', results);
      
      const diagnosisResult = results.diagnosisResult;
      console.log('🎯 診断結果:', diagnosisResult);
      
      if (diagnosisResult) {
        const { photographerType, scores, likedFeatures, dislikedFeatures, recommendations, advice } = diagnosisResult;
        console.log('📋 診断結果詳細:', {
          photographerType,
          scores,
          likedFeatures,
          dislikedFeatures,
          recommendations,
          advice
        });
        
        // フォトグラファータイプ表示
        if (photographerType) {
          // 動的キャラクター名を表示
          const personalityTypeElements = document.querySelectorAll('.personality-type');
          personalityTypeElements.forEach(element => {
            element.textContent = photographerType.name;
          });
          
          // 動的キャラクター説明を表示
          const personalityDescriptionElement = document.querySelector('.personality-description');
          if (personalityDescriptionElement) {
            personalityDescriptionElement.textContent = photographerType.description;
          }
          
          // タイトルも更新
          const titleElement = document.querySelector('.article-title');
          if (titleElement) {
            titleElement.innerHTML = `
              <span class="line-break">あなたは</span>
              <span class="personality-type">「${photographerType.name}」</span>
            `;
          }
          
          // サブタイトルも更新
          const subtitleElement = document.querySelector('.article-subtitle');
          if (subtitleElement) {
            subtitleElement.textContent = photographerType.description;
          }
        }
        
        // スコア表示
        if (scores) {
          displayScores(scores);
        }
        
        // おすすめ機材表示
        if (recommendations && recommendations.primary) {
          displayRecommendations(recommendations);
        } else {
          console.log('⚠️ おすすめ機材が生成されていません。デフォルト表示を使用します。');
          // デフォルトのおすすめ機材を表示
          displayDefaultRecommendations();
        }
        
        // アドバイス表示
        if (advice) {
          displayAdvice(advice);
        } else {
          console.log('⚠️ アドバイスが生成されていません。フォールバックを使用します。');
          // フォールバックアドバイスを表示
          displayAdvice({
            immediate: ['基本の露出（絞り・シャッタースピード・ISO）を理解しましょう', '構図の基本（三分割法）を練習しましょう'],
            long_term: ['撮影技術を向上させるために、定期的に練習を重ねましょう']
          });
        }
      } else {
        console.log('❌ 診断結果がありません。デフォルト表示を使用します。');
        // デフォルトの診断結果を表示
        displayDefaultResults();
      }
    }
    
    // デフォルト結果表示
    function displayDefaultResults() {
      console.log('📋 デフォルト結果を表示');
      
      // デフォルトのフォトグラファータイプ
      const defaultType = {
        name: 'カメラ愛好家',
        description: '写真を楽しむことを大切にするタイプです。'
      };
      
      // デフォルトのアドバイス
      const defaultAdvice = {
        immediate: ['基本の露出（絞り・シャッタースピード・ISO）を理解しましょう', '構図の基本（三分割法）を練習しましょう'],
        long_term: ['撮影技術を向上させるために、定期的に練習を重ねましょう']
      };
      
      // 表示を更新
      const personalityTypeElements = document.querySelectorAll('.personality-type');
      personalityTypeElements.forEach(element => {
        element.textContent = defaultType.name;
      });
      
      const personalityDescriptionElement = document.querySelector('.personality-description');
      if (personalityDescriptionElement) {
        personalityDescriptionElement.textContent = defaultType.description;
      }
      
      displayAdvice(defaultAdvice);
    }
    
    // デフォルトおすすめ機材表示
    function displayDefaultRecommendations() {
      console.log('📋 デフォルトおすすめ機材を表示');
      
      const defaultRecommendations = {
        primary: {
          brand: 'Sony',
          name: 'α7 IV',
          price: 298000,
          image: '/images/cameras/default-camera.svg'
        },
        alternatives: [
          {
            brand: 'Canon',
            name: 'EOS R6 Mark II',
            price: 348000,
            image: '/images/cameras/default-camera.svg'
          },
          {
            brand: 'Fujifilm',
            name: 'X-T5',
            price: 248000,
            image: '/images/cameras/default-camera.svg'
          }
        ]
      };
      
      displayRecommendations(defaultRecommendations);
    }
    
    function displayScores(scores) {
      const scoreElements = {
        'image_quality': document.querySelector('.stat-card:nth-child(1) .stat-number'),
        'autofocus': document.querySelector('.stat-card:nth-child(2) .stat-number'),
        'video_capability': document.querySelector('.stat-card:nth-child(3) .stat-number'),
        'portability': document.querySelector('.stat-card:nth-child(4) .stat-number')
      };
      
      if (scoreElements.image_quality) {
        scoreElements.image_quality.textContent = scores.image_quality || 87;
      }
      if (scoreElements.autofocus) {
        scoreElements.autofocus.textContent = scores.autofocus || 73;
      }
      if (scoreElements.video_capability) {
        scoreElements.video_capability.textContent = scores.video_capability || 91;
      }
      if (scoreElements.portability) {
        scoreElements.portability.textContent = scores.portability || 68;
      }
    }
    
    function displayRecommendations(recommendations) {
      console.log('📋 おすすめ機材表示:', recommendations);
      const recommendationCards = document.querySelectorAll('.recommendation-card');
      
      if (recommendations.primary && recommendationCards[0]) {
        const primary = recommendations.primary;
        const card = recommendationCards[0];
        
        card.querySelector('.recommendation-brand').textContent = primary.brand || 'ブランド不明';
        card.querySelector('.recommendation-name').textContent = primary.name || 'カメラ名不明';
        
        // 価格表示の安全な処理
        const price = primary.price;
        if (price && typeof price === 'number') {
          card.querySelector('.recommendation-price').textContent = `¥${price.toLocaleString()}`;
        } else if (price && typeof price === 'string') {
          card.querySelector('.recommendation-price').textContent = `¥${price}`;
        } else {
          card.querySelector('.recommendation-price').textContent = '価格未定';
        }
        
        // 画像の安全な処理
        const image = card.querySelector('img');
        if (image) {
          image.src = primary.image || '/images/cameras/default-camera.svg';
          image.alt = primary.name || 'カメラ画像';
          image.onerror = function() {
            this.src = '/images/cameras/default-camera.svg';
          };
        }
      }
      
      if (recommendations.alternatives && recommendations.alternatives.length > 0) {
        recommendations.alternatives.forEach((alt, index) => {
          if (recommendationCards[index + 1]) {
            const card = recommendationCards[index + 1];
            card.querySelector('.recommendation-brand').textContent = alt.brand || 'ブランド不明';
            card.querySelector('.recommendation-name').textContent = alt.name || 'カメラ名不明';
            
            // 価格表示の安全な処理
            const price = alt.price;
            if (price && typeof price === 'number') {
              card.querySelector('.recommendation-price').textContent = `¥${price.toLocaleString()}`;
            } else if (price && typeof price === 'string') {
              card.querySelector('.recommendation-price').textContent = `¥${price}`;
            } else {
              card.querySelector('.recommendation-price').textContent = '価格未定';
            }
            
            // 画像の安全な処理
            const image = card.querySelector('img');
            if (image) {
              image.src = alt.image || '/images/cameras/default-camera.svg';
              image.alt = alt.name || 'カメラ画像';
              image.onerror = function() {
                this.src = '/images/cameras/default-camera.svg';
              };
            }
          }
        });
      }
    }
    
    function displayAdvice(advice) {
      const adviceContainer = document.querySelector('.feature-list');
      if (!adviceContainer) return;
      
      let adviceHTML = '';
      let adviceNumber = 1;
      
      // 即座に実践できるアドバイス（最大2個）
      if (advice.immediate && advice.immediate.length > 0) {
        const immediateAdvice = advice.immediate.slice(0, 2);
        immediateAdvice.forEach((item) => {
          adviceHTML += `
            <li class="feature-item">
              <div class="feature-icon">${adviceNumber}</div>
              <div class="feature-content">
                <h4>即座に実践できるアドバイス</h4>
                <p>${item}</p>
              </div>
            </li>
          `;
          adviceNumber++;
        });
      }
      
      // 長期的な成長アドバイス（最大1個）
      if (advice.long_term && advice.long_term.length > 0) {
        const longTermAdvice = advice.long_term.slice(0, 1);
        longTermAdvice.forEach((item) => {
          adviceHTML += `
            <li class="feature-item">
              <div class="feature-icon">${adviceNumber}</div>
              <div class="feature-content">
                <h4>長期的な成長アドバイス</h4>
                <p>${item}</p>
              </div>
            </li>
          `;
          adviceNumber++;
        });
      }
      
      // アドバイスがない場合はデフォルトを表示
      if (!adviceHTML) {
        adviceHTML = `
          <li class="feature-item">
            <div class="feature-icon">1</div>
            <div class="feature-content">
              <h4>即座に実践できるアドバイス</h4>
              <p>基本の露出（絞り・シャッタースピード・ISO）を理解しましょう</p>
            </div>
          </li>
          <li class="feature-item">
            <div class="feature-icon">2</div>
            <div class="feature-content">
              <h4>即座に実践できるアドバイス</h4>
              <p>構図の基本を練習してください</p>
            </div>
          </li>
          <li class="feature-item">
            <div class="feature-icon">3</div>
            <div class="feature-content">
              <h4>長期的な成長アドバイス</h4>
              <p>撮影技術を向上させるために、定期的に練習を重ねましょう</p>
            </div>
          </li>
        `;
      }
      
      adviceContainer.innerHTML = adviceHTML;
    }
    
    function shareResults() {
      const results = JSON.parse(localStorage.getItem('cameraPickerResults') || '{}');
      const diagnosisResult = results.diagnosisResult;
      const photographerType = diagnosisResult?.photographerType?.name || 'カメラ愛好家';
      
      const title = "私の撮影スタイル診断結果";
      const text = `Camera Pickerで診断したところ「${photographerType}」でした！`;
      const url = window.location.href;
      
      if (navigator.share) {
        navigator.share({
          title: title,
          text: text,
          url: url
        });
      } else {
        // Fallback for browsers that don't support Web Share API
        navigator.clipboard.writeText(`${text} ${url}`).then(() => {
          alert('診断結果をクリップボードにコピーしました！');
        });
      }
    }
    
         function retakeDiagnosis() {
       if (confirm('診断をやり直しますか？現在の結果は失われます。')) {
         localStorage.removeItem('cameraPickerResults');
         localStorage.removeItem('cameraPickerProgress');
         window.location.href = 'index.html';
       }
     }
    
         function exploreGear() {
       // Navigate to detailed gear exploration
       window.location.href = 'pick.html';
     }
    
    function saveResults() {
      const diagnosisResult = JSON.parse(localStorage.getItem('cameraPickerResults') || '{}');
      const photographerType = diagnosisResult.diagnosisResult?.photographerType;
      
      const results = {
        personalityType: photographerType?.name || 'カメラ愛好家',
        timestamp: new Date().toISOString(),
        recommendations: [
          'Sony α7 IV',
          'Canon EOS R6 Mark II', 
          'Fujifilm X-T5'
        ]
      };
      
      localStorage.setItem('savedDiagnosisResults', JSON.stringify(results));
      
      // Show confirmation
      const button = event.target;
      const originalText = button.textContent;
      button.textContent = '保存完了！';
      button.style.background = 'var(--color-green)';
      
      setTimeout(() => {
        button.textContent = originalText;
        button.style.background = '';
      }, 2000);
    }
    
    // Animate elements on scroll
    function animateOnScroll() {
      const elements = document.querySelectorAll('.content-section, .recommendation-card, .stat-card');
      
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('animate-in');
            observer.unobserve(entry.target);
          }
        });
      }, {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      });
      
      elements.forEach(el => observer.observe(el));
    }
    
    // 動的にラベリングを更新する関数
    function updatePersonalityType() {
      try {
        const results = JSON.parse(localStorage.getItem('cameraPickerResults') || '{}');
        const diagnosisResult = results.diagnosisResult;
        const photographerType = diagnosisResult?.photographerType?.name || 'カメラ愛好家';
        
        // タイトルのラベリングを更新
        const titleElement = document.getElementById('dynamic-personality-type');
        if (titleElement) {
          titleElement.textContent = `「${photographerType}」`;
        }
        
        // カードのラベリングを更新
        const cardElement = document.getElementById('dynamic-personality-type-card');
        if (cardElement) {
          cardElement.textContent = photographerType;
        }
        
        console.log('✅ ラベリング更新完了:', photographerType);
      } catch (error) {
        console.error('❌ ラベリング更新エラー:', error);
      }
    }
    
    // Initialize animations when page loads
    document.addEventListener('DOMContentLoaded', () => {
      console.log('🚀 result.html DOM読み込み完了');
      
      // AI診断システムの読み込み確認
      if (window.cameraPickerAI) {
        console.log('✅ AI診断システム読み込み済み');
      } else {
        console.log('❌ AI診断システム未読み込み');
      }
      
      animateOnScroll();
      displayAIDiagnosis(); // AI診断結果を表示
      updatePersonalityType(); // ラベリングを動的に更新
    });
    
    // Add smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
          behavior: 'smooth'
        });
      });
    });
    // Service Worker registration
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
         navigator.serviceWorker.register('service-worker.js')
      .then(registration => {
        console.log('SW registered: ', registration);
      })
      .catch(registrationError => {
        console.log('SW registration failed: ', registrationError);
      });
  });
}
  </script>
</body>
</html>